.TH dtc_reinstall_os.sh 8
.SH NAME
dtc_reinstall_os \- reinstall an operating system in a VM
.SH SYNOPSIS
.B dtc_reinstall_os
[
.I -v
]
[ OPTIONS ]
.I VPS_NUMBER
.I HDD_SIZE
.I MEMORY_SIZE
.I IP_ADDRESS
.I PASSWORD
[
.I DISTRO
]
[
.I lvm|loopback
]

.SH DESCRIPTION
.B dtc_reinstall_os
.IP
This shell script is a part of the dtc-xen package that is to be used by the
dtc panel to manage a Xen VPS server.

.IP
When doing it's setup, dtc_reinstall_os will copy the file
/etc/dtc-xen/authorized_keys2 into the VPS's /root/.ssh/authorized_keys2, so
the administrator has access to the VPS without the need of shutting it down.
So it's a good idea to copy your shh public key in /etc/dtc-xen/authorized_keys2.

.LP
.B VPS_NUMBER
.IP
has to be a number between 01 and 29

.LP
.B HDD_SIZE
.IP
is not really used, but it's keeped to be consistant with dtc_setup_vps_disk

.LP
.B MEMORY_SIZE
is the amount of memory in mega bytes that you want to have setup
in the Xen startup file for this VPS

.LP
.B IP_ADDRESS
is a list of IPs that you want to be set in the VM's startup file and
in the VM's configuration. Note that the IPs have to be separated by spaces,
and thus you might want to use single quotes like this: '1.2.3.4 1.2.3.5'. Note
that only the first IP will be set in the VM's configuration, but the list will
be set in the Xen startup file so you can use the anti-spoofing facilities of
Xen if you need it (with untrusted users / unknown customers for example).

.LP
.B PASSWORD
is the root password you wish to have setup inside the VPS. Not all operating
system setup will suport it, but it's still a mandatory parameter.

.LP
.B [ DISTRO ]
is an optional parameter that can be debian, centos, gentoo or netbsd.
If ommited it will use debian as default. Note that for centos and gentoo,
you need to have the install files downloaded in /usr/src/gentoo:
.B portage-latest.tar.bz2
and
.B stage3-amd64-2006.1.tar.bz2
(if using amd64 arch) or
.B stage3-x86-2006.1.tar.bz2
(if using i[3456]86 arch).

.LP
.B [ lvm | loopback ]
You can then specify lvm or loopback. Currently the only value the script compares
to is lvm (or anything else), but this might change in the future. If ommited, then
lvm loopback is used.

.SH "OPTION"

If you don't set these options, then they have to be set in /etc/dtc-xen/dtc-xen.conf.

.LP
.B --netmask netmask
.IP
Guest OS netmask to setup.

.LP
.B --network network
.IP
Guest OS network to setup.

.LP
.B --broadcast broadcast
.IP
Guest OS broadcast to setup

.LP
.B --gateway gateway
.IP
Guest OS network gateway to setup

.LP
.B --nameservers dns1,dns2...
.IP
List of DNS servers in the /etc/resolv.conf of the VPS

.LP
.B -v
.IP
Without \-v, dtc_reinstall_os normally
outputs everything in /var/lib/dtc-xen/mnt/XX.stderr and
/var/lib/dtc-xen/mnt/XX.stdout (or wherever you have set the vps mountpoint to be),
to keep a log of the installation. With \-v, the redirection of standard output and
error is not done.

.SH "EXAMPLE"

.B dtc_reinstall_os 16 15360 256 '66.2.45.2 66.2.45.3' debian lvm

This will setup the VM called xen16, build it's startup file in /etc/xen/xen16 with
a vif containing ip=66.2.45.2 66.2.45.3 and 256 MB of RAM, setting-up a debian
stable operating system with 66.2.45.2 setup as eth0 IP address (66.2.45.3 is to
be added later on manually in /etc/network/interfaces later).

.SH "SEE ALSO"

dtc_setup_vps_disk(8), dtc_kill_vps_disk(8)

.SH "VERSION"
This documentation describes
.B dtc_reinstall_os
version 0.3.15.

See
.B http://www.gplhost.com/software-dtc-xen.html
for updates.
